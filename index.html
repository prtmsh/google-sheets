<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spreadsheet App</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/mathjs/lib/browser/math.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="toolbar" role="toolbar" aria-label="Spreadsheet Tools">
        <!-- Icon Buttons with Tooltips -->
        <button id="undo-btn" title="Undo last action" aria-label="Undo"><i class="fas fa-undo"></i></button>
        <button id="redo-btn" title="Redo last undone action" aria-label="Redo"><i class="fas fa-redo"></i></button>
        <button id="bold-btn" title="Make text bold" aria-label="Bold"><i class="fas fa-bold"></i></button>
        <button id="italic-btn" title="Make text italic" aria-label="Italic"><i class="fas fa-italic"></i></button>
        <select id="font-size" title="Select font size" aria-label="Font Size">
            <option value="12">12px</option>
            <option value="14">14px</option>
            <option value="16">16px</option>
        </select>
        <input type="color" id="font-color" value="#000000" title="Select text color" aria-label="Font Color" />
        <input type="color" id="bg-color" value="#ffffff" title="Select cell background color" aria-label="Background Color" />
        <button id="align-left-btn" title="Align text left" aria-label="Align Left"><i class="fas fa-align-left"></i></button>
        <button id="align-center-btn" title="Align text center" aria-label="Align Center"><i class="fas fa-align-center"></i></button>
        <button id="align-right-btn" title="Align text right" aria-label="Align Right"><i class="fas fa-align-right"></i></button>
        <button id="add-row-btn" title="Add new row at the bottom" aria-label="Add Row"><i class="fas fa-plus"></i> Row</button>
        <button id="delete-row-btn" title="Delete last row" aria-label="Delete Row"><i class="fas fa-minus"></i> Row</button>
        <button id="add-col-btn" title="Add new column at the right" aria-label="Add Column"><i class="fas fa-plus"></i> Col</button>
        <button id="delete-col-btn" title="Delete last column" aria-label="Delete Column"><i class="fas fa-minus"></i> Col</button>
        <select id="cell-type" title="Select data type for cells" aria-label="Cell Type">
            <option value="text">Text</option>
            <option value="number">Number</option>
            <option value="date">Date</option>
            <option value="dropdown">Dropdown</option>
        </select>
        <input type="text" id="dropdown-options" placeholder="Comma-separated options" style="display: none;" title="Enter options for dropdown, separated by commas" aria-label="Dropdown Options" />
        <button id="trim-btn" title="Trim whitespace in selected cells">Trim</button>
        <button id="upper-btn" title="Convert selected cells to uppercase">Upper</button>
        <button id="lower-btn" title="Convert selected cells to lowercase">Lower</button>
        <button id="remove-duplicates-btn" title="Remove duplicate rows in selection">Remove Duplicates</button>
        <input type="text" id="find-text" placeholder="Find" title="Text to find" aria-label="Find Text" />
        <input type="text" id="replace-text" placeholder="Replace" title="Text to replace with" aria-label="Replace Text" />
        <button id="find-replace-btn" title="Find and replace text in selection">Find & Replace</button>
        <button id="median-btn" title="Insert MEDIAN formula for selected range">Median</button>
        <button id="stdev-btn" title="Insert STDEV formula for selected range">StDev</button>
        <button id="load-sample-data" title="Load sample data for testing" aria-label="Load Sample Data"><i class="fas fa-file-import"></i></button>
        <button id="run-tests" title="Run predefined tests" aria-label="Run Tests"><i class="fas fa-vial"></i></button>
        <button id="save-btn" title="Save spreadsheet to local storage" aria-label="Save"><i class="fas fa-save"></i></button>
        <button id="load-btn" title="Load spreadsheet from local storage" aria-label="Load"><i class="fas fa-upload"></i></button>
        <button id="export-csv-btn" title="Export spreadsheet to CSV file" aria-label="Export CSV"><i class="fas fa-download"></i></button>
        <button id="import-csv-btn" title="Import spreadsheet from CSV file" aria-label="Import CSV"><i class="fas fa-file-upload"></i></button>
        <input type="file" id="csv-file" accept=".csv" style="display: none;" aria-label="CSV File Input" />
        <button id="generate-chart" title="Generate bar chart from selected data" aria-label="Generate Chart"><i class="fas fa-chart-bar"></i></button>
    </div>
    <div class="formula-bar" role="region" aria-label="Formula Bar">
        <input type="text" id="formula-input" placeholder="Enter formula (e.g., =SUM(A1:A5) or =A1+B1)" aria-label="Formula Input" />
    </div>
    <div class="spreadsheet" id="spreadsheet" role="grid" aria-label="Spreadsheet Grid"></div>
    <canvas id="chart" width="400" height="200" aria-label="Data Chart"></canvas>
    <div id="context-menu" class="context-menu" role="menu" aria-label="Context Menu">
        <div class="menu-item" data-action="copy" role="menuitem">Copy</div>
        <div class="menu-item" data-action="paste" role="menuitem">Paste</div>
        <div class="menu-item" data-action="cut" role="menuitem">Cut</div>
    </div>
    <script src="script.js"></script>
</body>
</html>